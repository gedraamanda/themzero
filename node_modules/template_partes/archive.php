<?php
$paged = ( get_query_var( 'paged' ) ) ? get_query_var( 'paged' ) : 1;

if ( is_tag() ) {
	$tag   = get_queried_object();
    $titulo = $tag->name;

	$postsList = new WP_Query( array(
		'post_type'      => array( 'any' ),
		'posts_per_page' => 6,
        'post_status' => 'publish',
        'tag_id' => $tag->term_id,
		'paged' => $paged
	) );

	$cat = false;

} elseif ( is_tax( 'categoria_veiculos' ) ) {
	$veiculo   = get_queried_object();
	$titulo = $veiculo->name;

	$postsList = new WP_Query( array(
		'post_type'      => array( 'any' ),
		'posts_per_page' => 6,
		'post_status' => 'publish',
		'tax_query' => array(
			array (
				'taxonomy' => 'categoria_veiculos',
				'field' => 'slug',
				'terms' => $veiculo->slug,
			)
		),
		'paged' => $paged
	) );

	$cat = false;
} elseif ( is_search() ) {
	$pesquisa = $_GET['s'];
	$titulo   = $pesquisa;

	$postsList = new WP_Query( array(
		'post_type'      => array( 'any' ),
		'post_status'    => 'publish',
		's'              => $pesquisa,
		'posts_per_page' => 6,
		'paged' => $paged
	) );

	$cat = true;
}
?>

<div class="container arquivo mt-4 mt-md-5">
    <header>
        <h1 class="m-0 text-center">"<?php echo $titulo ?>"</h1>
    </header>

    <div class="arquivo__posts mt-5">
        <div class="row ">
            <?php
            if ( $postsList->have_posts() ) {

	            while ( $postsList->have_posts() ) : $postsList->the_post();

		            $img_destaque = get_the_post_thumbnail_url( get_the_ID(), 'large' );
		            $linha_fina   = get_field( 'intro-do-texto', get_the_ID() );
	            ?>

                    <div class="col-12 col-md-4 mb-5">
                        <div class="posts-block">
                            <a href="<?php echo get_permalink(get_the_ID()) ?>" class="mb-3 d-block">
                                <div class="imagem" style="background: url('<?php echo $img_destaque ?>');"></div>

                                <div class="texto ">
                                    <h3 class="m-0 text-uppercase my-2"><?php the_title() ?></h3>

						            <?php if ( ! empty( $linha_fina ) ) {
							            echo '<span class="olho">' . $linha_fina . '</span>';
						            } ?>

                                </div>
                            </a>
                        </div>
                    </div>

	            <?php
                endwhile; // end of the loop.

	            wp_pagenavi(  );


            }  else {
                echo 'Nenhum resultado!';
            }?>

        </div>
    </div>
</div>